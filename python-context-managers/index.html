<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.5625 'Source Sans Pro',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Source Sans Pro',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;color:hsla(0,0%,0%,1);font-family:'Source Serif Pro',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;color:hsla(0,0%,0%,1);font-family:'Source Serif Pro',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;color:hsla(0,0%,0%,1);font-family:'Source Serif Pro',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;color:hsla(0,0%,0%,1);font-family:'Source Serif Pro',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;color:hsla(0,0%,0%,1);font-family:'Source Serif Pro',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;color:hsla(0,0%,0%,1);font-family:'Source Serif Pro',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}ul{margin-left:1.5625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.5625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;font-size:0.85rem;line-height:1.5625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;font-size:1rem;line-height:1.5625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}blockquote{margin-left:0;margin-right:1.5625rem;margin-top:0;padding-bottom:0;padding-left:1.75781rem;padding-right:0;padding-top:0;margin-bottom:1.5625rem;font-size:1.1487rem;line-height:1.5625rem;color:hsla(0,0%,0%,0.59);border-left:0.58594rem solid;border-color:#fcea0e;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.5625rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.5625rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.5625rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.5625rem;margin-bottom:calc(1.5625rem / 2);margin-top:calc(1.5625rem / 2);}li > ul{margin-left:1.5625rem;margin-bottom:calc(1.5625rem / 2);margin-top:calc(1.5625rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.5625rem / 2);}code{font-size:0.85rem;line-height:1.5625rem;}kbd{font-size:0.85rem;line-height:1.5625rem;}samp{font-size:0.85rem;line-height:1.5625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.04167rem;padding-right:1.04167rem;padding-top:0.78125rem;padding-bottom:calc(0.78125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#fb251b;text-decoration:none;}a:hover,a:active{color:hsla(0,0%,0%,0.8);}h1,h2,h3,h4,h5,h6{margin-top:3.125rem;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.5625rem;color:hsla(0,0%,0%,0.8);font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){blockquote{margin-left:-1.17188rem;margin-right:0;border-left:0.29297rem solid;border-color:#fcea0e;padding-left:0.87891rem;}}</style><style data-href="/styles.56118bbba284d4b48bef.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}body{font-size:1.125rem}.gatsby-highlight-code-line{background-color:#feb;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #f99}.gatsby-highlight{background-color:#fdf6e3;border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto;font-size:1rem}.gatsby-highlight pre[class*=language-]{background-color:transparent;margin:0;padding:0;overflow:initial;float:left;min-width:100%}.gatsby-highlight pre[class*=language-].line-numbers{padding-left:2.8em}code[class*=language-]{font-size:.8725em}pre[class*=language-]{white-space:pre-wrap}@media (max-width:570px){pre[class*=language-]{font-size:.8585em}.gatsby-highlight{padding:.5em}}@media (max-width:400px){pre[class*=language-]{font-size:.7585em}.gatsby-highlight{padding:.1em}}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.Contacts-module--contact--2oV3v{border-radius:5px;display:flex;align-items:center;padding:2px 6px}.Contacts-module--contact--2oV3v svg{width:2rem;height:2rem}.Header-module--wrapper--3rZRj{background:#fff}.Header-module--container--1_Tic{box-shadow:4px 9px 19px -9px rgba(46,46,46,.08);display:flex;flex-direction:column;margin:0 auto 1.45rem;padding:1rem;align-items:center}.Header-module--profile--UfaXD{min-width:70px;max-width:150px;margin:1rem}.Header-module--profile--UfaXD img{margin:0}.Header-module--title--3JWMg{margin:0 1rem}.Header-module--title--3JWMg h1{font-size:1.875rem;margin:0}.Header-module--description--2J229{margin:1rem}.Header-module--contacts__list--35I1U{line-height:0}.Header-module--contacts__list--35I1U>a{display:inline-block;margin:0 5px}.Header-module--contacts__list--35I1U>a>div{background-color:hsla(0,0%,100%,.99);border-radius:5px;display:flex;align-items:center;padding:2px 6px;color:rgba(40,40,40,.99)}.Header-module--contacts__list--35I1U>a>div svg{width:2rem;height:2rem;fill:rgba(40,40,40,.99)}.Header-module--contacts__list--35I1U>a>div:hover{background-color:rgba(40,40,40,.99);color:hsla(0,0%,100%,.99)}.Header-module--contacts__list--35I1U>a>div:hover svg{fill:hsla(0,0%,100%,.99)}@media (max-width:780px){.Header-module--profile--UfaXD{max-width:100px}.Header-module--title--3JWMg h1{font-size:1.725rem}}.NavBar-module--nav--1LgU7{display:grid;grid-template-columns:54px auto;grid-template-rows:auto;align-items:center;padding:.7725rem .7725rem .6725rem;margin-bottom:1.45rem;max-width:800px}.NavBar-module--miniProfile--1dTnS{justify-self:center;max-width:55px}.NavBar-module--miniProfile--1dTnS a{display:table-cell}.NavBar-module--miniProfile--1dTnS img{margin-bottom:0}.NavBar-module--miniTitle--3uGCM{justify-self:left}.NavBar-module--miniTitle--3uGCM h1{font-size:18px;margin:0 .7rem}.Sidebar-module--sidebar--X4z2p{background-color:#fff;box-shadow:-8px 9px 14px rgba(0,0,0,.06);padding:85px 45px 0 10px;position:fixed;right:0;top:0;min-height:100vh;width:265px;z-index:10;display:flex;flex-direction:column;align-items:flex-end}.Sidebar-module--spring-btn__wrapper--2Qrog{position:absolute;top:27px;right:35px;z-index:12}.Sidebar-module--spring-btn__container--CZiIu{width:100%;height:100%;display:flex;align-items:flex-start;justify-content:center}.Sidebar-module--spring-btn__container--CZiIu .Sidebar-module--btn--39pDC{height:28px;width:28px;padding:0;margin:0;display:flex;align-items:center;justify-content:center;background-color:transparent}.Sidebar-module--spring-btn__container--CZiIu .Sidebar-module--animated--z49M3{position:absolute;cursor:pointer;will-change:transform,opacity}.Sidebar-module--spring-btn__container--CZiIu .Sidebar-module--animated--z49M3 svg{fill:#505050}.Sidebar-module--spring-btn__container--CZiIu .Sidebar-module--animated--z49M3 svg:hover{fill:#282828}.Sidebar-module--contacts__list--1j8h2{line-height:0;display:flex;flex-direction:column;align-items:flex-end}.Sidebar-module--contacts__list--1j8h2>a{display:inline-block}.Sidebar-module--contacts__list--1j8h2>a>div{border-radius:5px;display:flex;flex-direction:row-reverse;align-items:center;padding:2px 0;color:#646464;margin-top:5px}.Sidebar-module--contacts__list--1j8h2>a>div span{margin-right:8px}.Sidebar-module--contacts__list--1j8h2>a>div svg{width:2rem;height:2rem;fill:#646464}.Sidebar-module--contacts__list--1j8h2>a>div:hover{color:#141414}.Sidebar-module--contacts__list--1j8h2>a>div:hover svg{fill:#141414}.Sidebar-module--delimeter--1KQOd{background:#dcdcdc;margin:25px 2px;height:8px;width:80px}.Sidebar-module--link---ZkJc{margin:8px 3px;color:#646464}.Sidebar-module--link---ZkJc :hover{color:#141414}.Layout-module--layout--3Pyz6{margin:0 auto;max-width:800px;padding:0 1.0875rem 1.45rem}.Layout-module--layout--3Pyz6 .Layout-module--content--23chO{min-height:80vh}.Layout-module--layout--3Pyz6 blockquote{background:#f9f9f9;font-style:italic;border-left:10px solid #bbb;margin:1.5em .5rem;padding:.4rem 1rem;quotes:"\201C" "\201D" "\2018" "\2019";font-size:1rem}.Layout-module--layout--3Pyz6 blockquote:before{color:#ccc;content:open-quote;font-size:4em;line-height:.1em;margin-right:.2em;vertical-align:-.4em}.Layout-module--layout--3Pyz6 blockquote p{display:inline}@media (max-width:460px){.Layout-module--layout--3Pyz6{width:100%;padding:0}}.Tags-module--tags__list--2uniP{display:flex;margin:0;padding:0}.Tags-module--tags__list-item--2cArz{display:flex;align-items:center;padding:.1rem .37rem;margin:0 .28rem 0 0;background-color:rgba(21,66,163,.85);color:#fff;font-size:13px;border-radius:4px}.Tags-module--tags__list-item-icon--32khN{display:inline-block}.Tags-module--tags__list-item-icon--32khN svg{width:18px;-webkit-filter:invert(.99);filter:invert(.99);margin:0 3px -5px 0}.Tags-module--hashtag--lnfoq{color:#67717d}.blog-post-module--article--2aW_3{max-width:800px;margin:0 auto 2rem;padding:0 .6rem 1.5rem;box-shadow:0 20px 10px -10px rgba(0,0,0,.04)}.blog-post-module--dateWrapper--3K-_O{color:#67717d;display:flex;justify-content:flex-start;align-items:flex-start}.blog-post-module--dateWrapper--3K-_O .blog-post-module--dateIcon--2joj4{margin-top:0}.blog-post-module--dateWrapper--3K-_O .blog-post-module--dateIcon--2joj4 svg{width:20px;-webkit-filter:invert(.6);filter:invert(.6);display:inline;margin:8px 0 0}.blog-post-module--dateWrapper--3K-_O .blog-post-module--dateText--1kEfw{font-size:14px;margin-top:8px;margin-left:14px}.blog-post-module--tagsWrapper--3wgOP{color:#67717d;display:flex;justify-content:flex-start;align-items:flex-start}.blog-post-module--tagsWrapper--3wgOP .blog-post-module--tagIcon--7bFtR{margin-top:0}.blog-post-module--tagsWrapper--3wgOP .blog-post-module--tagIcon--7bFtR svg{width:20px;-webkit-filter:invert(.6);filter:invert(.6);display:inline;margin:10px 0 0}.blog-post-module--tagsWrapper--3wgOP .blog-post-module--tags--2K_EU{margin-top:8px;margin-left:14px}.blog-post-module--navlinks--Iep78{max-width:800px;margin:3rem auto}.blog-post-module--navprev--1GRP9{display:inline-block;margin-right:2rem;margin-bottom:1rem}.blog-post-module--navnext--3Yd9-{display:inline-block;margin-left:2rem;float:right}.blog-post-module--navlinkdiv--f3pWb a:hover{text-decoration:underline}.index-module--blogpostsList--1Ht1s{max-width:800px;margin:0 auto}.index-module--blogpost--1aLtT{border-left:15px solid rgba(21,66,163,.85);box-shadow:4px 9px 19px -9px rgba(46,46,46,.15);padding:1px 25px;margin:50px 0}.index-module--excerpt--2pHHd{color:#3c3c3c}.index-module--excerpt--2pHHd ul{margin-bottom:.8rem}.index-module--excerpt--2pHHd ul li{margin-bottom:0}.index-module--excerpt--2pHHd h1,.index-module--excerpt--2pHHd h2,.index-module--excerpt--2pHHd h3,.index-module--excerpt--2pHHd h4,.index-module--excerpt--2pHHd h5,.index-module--excerpt--2pHHd h6{color:#3c3c3c;margin-bottom:.8rem;margin-top:1.2rem}@media (max-width:460px){.index-module--blogpost--1aLtT{border-left:12px solid rgba(21,66,163,.85);box-shadow:4px 9px 19px -9px rgba(46,46,46,.15);padding:1px 20px;margin:30px 0}}</style><meta name="generator" content="Gatsby 2.20.3"/><title data-react-helmet="true"></title><link rel="icon" href="/icons/icon-48x48.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#004C99"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=1c2d4ebaa83efc703814c3f765792108"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=1c2d4ebaa83efc703814c3f765792108"/><link href="//fonts.googleapis.com/css?family=Source+Serif+Pro:600|Source+Sans+Pro:400,400i,700" rel="stylesheet" type="text/css"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-9ffd9fadeba4c79ed312.js"/><link as="script" rel="preload" href="/app-bfa7222071ec5d114ab1.js"/><link as="script" rel="preload" href="/styles-277438bf92f1a9bf84e5.js"/><link as="script" rel="preload" href="/commons-02da7c81015f33fc39a7.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-1b780e47f8d886e9432d.js"/><link as="fetch" rel="preload" href="/page-data/python-context-managers/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="box-shadow:10px 9px 14px rgba(0,0,0,.025)"><div class="NavBar-module--nav--1LgU7"><div class="NavBar-module--miniProfile--1dTnS"><img alt="" style="border-radius:50%" src="/static/profile_pic_888-6355e50962f568ef5a1a7ee334859095.jpg"/></div><div class="NavBar-module--miniTitle--3uGCM"><h1><a style="color:black;text-decoration:none" href="/">Evgeny Roskach</a></h1></div></div></div><div class="Sidebar-module--spring-btn__wrapper--2Qrog"><div class="Sidebar-module--spring-btn__container--CZiIu"><div class="Sidebar-module--btn--39pDC Sidebar-module--animated--z49M3" style="opacity:1;transform:rotate(0deg) scale(1, 1)"><svg height="27" viewBox="0 -53 384 384" width="27"><path d="M368 154.668H16c-8.832 0-16-7.168-16-16s7.168-16 16-16h352c8.832 0 16 7.168 16 16s-7.168 16-16 16zm0 0M368 32H16C7.168 32 0 24.832 0 16S7.168 0 16 0h352c8.832 0 16 7.168 16 16s-7.168 16-16 16zm0 0M368 277.332H16c-8.832 0-16-7.168-16-16s7.168-16 16-16h352c8.832 0 16 7.168 16 16s-7.168 16-16 16zm0 0"></path></svg></div><div class="Sidebar-module--btn--39pDC Sidebar-module--animated--z49M3" style="opacity:0;transform:rotate(0deg) scale(0, 0)"><svg viewBox="0 0 492 492" width="22" height="22"><path d="M300.188 246L484.14 62.04c5.06-5.064 7.852-11.82 7.86-19.024 0-7.208-2.792-13.972-7.86-19.028L468.02 7.872C462.952 2.796 456.196.016 448.984.016c-7.2 0-13.956 2.78-19.024 7.856L246.008 191.82 62.048 7.872C56.988 2.796 50.228.016 43.02.016c-7.2 0-13.96 2.78-19.02 7.856L7.872 23.988c-10.496 10.496-10.496 27.568 0 38.052L191.828 246 7.872 429.952C2.808 435.024.02 441.78.02 448.984c0 7.204 2.788 13.96 7.852 19.028l16.124 16.116c5.06 5.072 11.824 7.856 19.02 7.856 7.208 0 13.968-2.784 19.028-7.856l183.96-183.952 183.952 183.952c5.068 5.072 11.824 7.856 19.024 7.856h.008c7.204 0 13.96-2.784 19.028-7.856l16.12-16.116c5.06-5.064 7.852-11.824 7.852-19.028 0-7.204-2.792-13.96-7.852-19.028L300.188 246z"></path></svg></div></div></div><div class="Sidebar-module--sidebar--X4z2p" style="right:-300px"><div class="Sidebar-module--contacts__list--1j8h2"><a href="https://github.com/genyrosk" target="_blank"><div class="Contacts-module--contact--2oV3v"><svg viewBox="0 0 30 30"><path d="M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"></path></svg><span>@genyrosk</span></div></a><a href="https://www.linkedin.com/in/eroskach/" target="_blank"><div class="Contacts-module--contact--2oV3v"><svg viewBox="0 0 30 30"><path d="M24,4H6C4.895,4,4,4.895,4,6v18c0,1.105,0.895,2,2,2h18c1.105,0,2-0.895,2-2V6C26,4.895,25.105,4,24,4z M10.954,22h-2.95 v-9.492h2.95V22z M9.449,11.151c-0.951,0-1.72-0.771-1.72-1.72c0-0.949,0.77-1.719,1.72-1.719c0.948,0,1.719,0.771,1.719,1.719 C11.168,10.38,10.397,11.151,9.449,11.151z M22.004,22h-2.948v-4.616c0-1.101-0.02-2.517-1.533-2.517 c-1.535,0-1.771,1.199-1.771,2.437V22h-2.948v-9.492h2.83v1.297h0.04c0.394-0.746,1.356-1.533,2.791-1.533 c2.987,0,3.539,1.966,3.539,4.522V22z"></path></svg><span>in/eroskach</span></div></a></div><div class="Sidebar-module--delimeter--1KQOd"></div><a class="Sidebar-module--link---ZkJc" href="/">home</a><a class="Sidebar-module--link---ZkJc" href="/about-me/">about me</a></div><div class="Layout-module--layout--3Pyz6"><div class="Layout-module--content--23chO"><div class="blog-post-module--article--2aW_3"><div style="margin-bottom:40px"><h1>Build a request limiter using Python context managers (and decorators)</h1><div class="blog-post-module--tagsWrapper--3wgOP"><div><ul class="Tags-module--tags__list--2uniP"><li class="Tags-module--tags__list-item--2cArz"><span class="Tags-module--tags__list-item-icon--32khN"><svg viewBox="0 0 486.982 486.982"><path d="M131.35,422.969c14.6,14.6,38.3,14.6,52.9,0l181.1-181.1c5.2-5.2,9.2-11.4,11.8-18c18.2,5.1,35.9,7.8,51.5,7.7c38.6-0.2,51.4-17.1,55.6-27.2c4.2-10,7.2-31-19.9-58.6c-0.3-0.3-0.6-0.6-0.9-0.9c-16.8-16.8-41.2-32.3-68.9-43.8c-5.1-2.1-10.2-4-15.2-5.8v-0.3c-0.3-22.2-18.2-40.1-40.4-40.4l-108.5-1.5c-14.4-0.2-28.2,5.4-38.3,15.6l-181.2,181.1c-14.6,14.6-14.6,38.3,0,52.9L131.35,422.969z M270.95,117.869c12.1-12.1,31.7-12.1,43.8,0c7.2,7.2,10.1,17.1,8.7,26.4c11.9,8.4,26.1,16.2,41.3,22.5c5.4,2.2,10.6,4.2,15.6,5.9l-0.6-43.6c0.9,0.4,1.7,0.7,2.6,1.1c23.7,9.9,45,23.3,58.7,37c0.2,0.2,0.4,0.4,0.6,0.6c13,13.3,14.4,21.8,13.3,24.4c-3.4,8.1-39.9,15.3-95.3-7.8c-16.2-6.8-31.4-15.2-43.7-24.3c-0.4,0.5-0.9,1-1.3,1.5c-12.1,12.1-31.7,12.1-43.8,0C258.85,149.569,258.85,129.969,270.95,117.869z"></path></svg></span><span>python</span></li><li class="Tags-module--tags__list-item--2cArz"><span class="Tags-module--tags__list-item-icon--32khN"><svg viewBox="0 0 486.982 486.982"><path d="M131.35,422.969c14.6,14.6,38.3,14.6,52.9,0l181.1-181.1c5.2-5.2,9.2-11.4,11.8-18c18.2,5.1,35.9,7.8,51.5,7.7c38.6-0.2,51.4-17.1,55.6-27.2c4.2-10,7.2-31-19.9-58.6c-0.3-0.3-0.6-0.6-0.9-0.9c-16.8-16.8-41.2-32.3-68.9-43.8c-5.1-2.1-10.2-4-15.2-5.8v-0.3c-0.3-22.2-18.2-40.1-40.4-40.4l-108.5-1.5c-14.4-0.2-28.2,5.4-38.3,15.6l-181.2,181.1c-14.6,14.6-14.6,38.3,0,52.9L131.35,422.969z M270.95,117.869c12.1-12.1,31.7-12.1,43.8,0c7.2,7.2,10.1,17.1,8.7,26.4c11.9,8.4,26.1,16.2,41.3,22.5c5.4,2.2,10.6,4.2,15.6,5.9l-0.6-43.6c0.9,0.4,1.7,0.7,2.6,1.1c23.7,9.9,45,23.3,58.7,37c0.2,0.2,0.4,0.4,0.6,0.6c13,13.3,14.4,21.8,13.3,24.4c-3.4,8.1-39.9,15.3-95.3-7.8c-16.2-6.8-31.4-15.2-43.7-24.3c-0.4,0.5-0.9,1-1.3,1.5c-12.1,12.1-31.7,12.1-43.8,0C258.85,149.569,258.85,129.969,270.95,117.869z"></path></svg></span><span>context manager</span></li><li class="Tags-module--tags__list-item--2cArz"><span class="Tags-module--tags__list-item-icon--32khN"><svg viewBox="0 0 486.982 486.982"><path d="M131.35,422.969c14.6,14.6,38.3,14.6,52.9,0l181.1-181.1c5.2-5.2,9.2-11.4,11.8-18c18.2,5.1,35.9,7.8,51.5,7.7c38.6-0.2,51.4-17.1,55.6-27.2c4.2-10,7.2-31-19.9-58.6c-0.3-0.3-0.6-0.6-0.9-0.9c-16.8-16.8-41.2-32.3-68.9-43.8c-5.1-2.1-10.2-4-15.2-5.8v-0.3c-0.3-22.2-18.2-40.1-40.4-40.4l-108.5-1.5c-14.4-0.2-28.2,5.4-38.3,15.6l-181.2,181.1c-14.6,14.6-14.6,38.3,0,52.9L131.35,422.969z M270.95,117.869c12.1-12.1,31.7-12.1,43.8,0c7.2,7.2,10.1,17.1,8.7,26.4c11.9,8.4,26.1,16.2,41.3,22.5c5.4,2.2,10.6,4.2,15.6,5.9l-0.6-43.6c0.9,0.4,1.7,0.7,2.6,1.1c23.7,9.9,45,23.3,58.7,37c0.2,0.2,0.4,0.4,0.6,0.6c13,13.3,14.4,21.8,13.3,24.4c-3.4,8.1-39.9,15.3-95.3-7.8c-16.2-6.8-31.4-15.2-43.7-24.3c-0.4,0.5-0.9,1-1.3,1.5c-12.1,12.1-31.7,12.1-43.8,0C258.85,149.569,258.85,129.969,270.95,117.869z"></path></svg></span><span>decorator</span></li><li class="Tags-module--tags__list-item--2cArz"><span class="Tags-module--tags__list-item-icon--32khN"><svg viewBox="0 0 486.982 486.982"><path d="M131.35,422.969c14.6,14.6,38.3,14.6,52.9,0l181.1-181.1c5.2-5.2,9.2-11.4,11.8-18c18.2,5.1,35.9,7.8,51.5,7.7c38.6-0.2,51.4-17.1,55.6-27.2c4.2-10,7.2-31-19.9-58.6c-0.3-0.3-0.6-0.6-0.9-0.9c-16.8-16.8-41.2-32.3-68.9-43.8c-5.1-2.1-10.2-4-15.2-5.8v-0.3c-0.3-22.2-18.2-40.1-40.4-40.4l-108.5-1.5c-14.4-0.2-28.2,5.4-38.3,15.6l-181.2,181.1c-14.6,14.6-14.6,38.3,0,52.9L131.35,422.969z M270.95,117.869c12.1-12.1,31.7-12.1,43.8,0c7.2,7.2,10.1,17.1,8.7,26.4c11.9,8.4,26.1,16.2,41.3,22.5c5.4,2.2,10.6,4.2,15.6,5.9l-0.6-43.6c0.9,0.4,1.7,0.7,2.6,1.1c23.7,9.9,45,23.3,58.7,37c0.2,0.2,0.4,0.4,0.6,0.6c13,13.3,14.4,21.8,13.3,24.4c-3.4,8.1-39.9,15.3-95.3-7.8c-16.2-6.8-31.4-15.2-43.7-24.3c-0.4,0.5-0.9,1-1.3,1.5c-12.1,12.1-31.7,12.1-43.8,0C258.85,149.569,258.85,129.969,270.95,117.869z"></path></svg></span><span>generator</span></li><li class="Tags-module--tags__list-item--2cArz"><span class="Tags-module--tags__list-item-icon--32khN"><svg viewBox="0 0 486.982 486.982"><path d="M131.35,422.969c14.6,14.6,38.3,14.6,52.9,0l181.1-181.1c5.2-5.2,9.2-11.4,11.8-18c18.2,5.1,35.9,7.8,51.5,7.7c38.6-0.2,51.4-17.1,55.6-27.2c4.2-10,7.2-31-19.9-58.6c-0.3-0.3-0.6-0.6-0.9-0.9c-16.8-16.8-41.2-32.3-68.9-43.8c-5.1-2.1-10.2-4-15.2-5.8v-0.3c-0.3-22.2-18.2-40.1-40.4-40.4l-108.5-1.5c-14.4-0.2-28.2,5.4-38.3,15.6l-181.2,181.1c-14.6,14.6-14.6,38.3,0,52.9L131.35,422.969z M270.95,117.869c12.1-12.1,31.7-12.1,43.8,0c7.2,7.2,10.1,17.1,8.7,26.4c11.9,8.4,26.1,16.2,41.3,22.5c5.4,2.2,10.6,4.2,15.6,5.9l-0.6-43.6c0.9,0.4,1.7,0.7,2.6,1.1c23.7,9.9,45,23.3,58.7,37c0.2,0.2,0.4,0.4,0.6,0.6c13,13.3,14.4,21.8,13.3,24.4c-3.4,8.1-39.9,15.3-95.3-7.8c-16.2-6.8-31.4-15.2-43.7-24.3c-0.4,0.5-0.9,1-1.3,1.5c-12.1,12.1-31.7,12.1-43.8,0C258.85,149.569,258.85,129.969,270.95,117.869z"></path></svg></span><span>rate limiter</span></li><li class="Tags-module--tags__list-item--2cArz"><span class="Tags-module--tags__list-item-icon--32khN"><svg viewBox="0 0 486.982 486.982"><path d="M131.35,422.969c14.6,14.6,38.3,14.6,52.9,0l181.1-181.1c5.2-5.2,9.2-11.4,11.8-18c18.2,5.1,35.9,7.8,51.5,7.7c38.6-0.2,51.4-17.1,55.6-27.2c4.2-10,7.2-31-19.9-58.6c-0.3-0.3-0.6-0.6-0.9-0.9c-16.8-16.8-41.2-32.3-68.9-43.8c-5.1-2.1-10.2-4-15.2-5.8v-0.3c-0.3-22.2-18.2-40.1-40.4-40.4l-108.5-1.5c-14.4-0.2-28.2,5.4-38.3,15.6l-181.2,181.1c-14.6,14.6-14.6,38.3,0,52.9L131.35,422.969z M270.95,117.869c12.1-12.1,31.7-12.1,43.8,0c7.2,7.2,10.1,17.1,8.7,26.4c11.9,8.4,26.1,16.2,41.3,22.5c5.4,2.2,10.6,4.2,15.6,5.9l-0.6-43.6c0.9,0.4,1.7,0.7,2.6,1.1c23.7,9.9,45,23.3,58.7,37c0.2,0.2,0.4,0.4,0.6,0.6c13,13.3,14.4,21.8,13.3,24.4c-3.4,8.1-39.9,15.3-95.3-7.8c-16.2-6.8-31.4-15.2-43.7-24.3c-0.4,0.5-0.9,1-1.3,1.5c-12.1,12.1-31.7,12.1-43.8,0C258.85,149.569,258.85,129.969,270.95,117.869z"></path></svg></span><span>tutorial</span></li></ul></div></div><div class="blog-post-module--dateWrapper--3K-_O"><div class="blog-post-module--dateIcon--2joj4"><svg viewBox="0 0 485.213 485.212"><path d="M60.652,75.816V15.163C60.652,6.781,67.433,0,75.817,0c8.38,0,15.161,6.781,15.161,15.163v60.653c0,8.38-6.781,15.161-15.161,15.161C67.433,90.978,60.652,84.196,60.652,75.816z M318.424,90.978c8.378,0,15.163-6.781,15.163-15.161V15.163C333.587,6.781,326.802,0,318.424,0c-8.382,0-15.168,6.781-15.168,15.163v60.653C303.256,84.196,310.042,90.978,318.424,90.978z M485.212,363.906c0,66.996-54.312,121.307-121.303,121.307c-66.986,0-121.302-54.311-121.302-121.307c0-66.986,54.315-121.3,121.302-121.3C430.9,242.606,485.212,296.919,485.212,363.906zM454.89,363.906c0-50.161-40.81-90.976-90.98-90.976c-50.166,0-90.976,40.814-90.976,90.976c0,50.171,40.81,90.98,90.976,90.98C414.08,454.886,454.89,414.077,454.89,363.906z M121.305,181.955H60.652v60.651h60.653V181.955z M60.652,333.584h60.653V272.93H60.652V333.584z M151.629,242.606h60.654v-60.651h-60.654V242.606z M151.629,333.584h60.654V272.93h-60.654V333.584zM30.328,360.891V151.628h333.582v60.653h30.327V94c0-18.421-14.692-33.349-32.843-33.349h-12.647v15.166c0,16.701-13.596,30.325-30.322,30.325c-16.731,0-30.326-13.624-30.326-30.325V60.651H106.14v15.166c0,16.701-13.593,30.325-30.322,30.325c-16.733,0-30.327-13.624-30.327-30.325V60.651H32.859C14.707,60.651,0.001,75.579,0.001,94v266.892c0,18.36,14.706,33.346,32.858,33.346h179.424v-30.331H32.859C31.485,363.906,30.328,362.487,30.328,360.891zM303.256,242.606v-60.651h-60.648v60.651H303.256z M409.399,363.906h-45.49v-45.49c0-8.377-6.781-15.158-15.163-15.158s-15.159,6.781-15.159,15.158v60.658c0,8.378,6.777,15.163,15.159,15.163h60.653c8.382,0,15.163-6.785,15.163-15.163C424.562,370.692,417.781,363.906,409.399,363.906z"></path></svg></div><div class="blog-post-module--dateText--1kEfw">Dec 31, 2018<!-- --> <span> · </span> <!-- -->10<!-- --> min read</div></div></div><div><h2>A real problem I encountered</h2>
<p>While learning to use Python Context Managers, I encountered a neat use case for them. At the time I was writing a data pipeline that was heavily querying an API and I would often quickly reach the API quota limits and my script would abruptly quit. My initial solution was to catch the exception and implement a loop that would try again after a time delay. It was a quick and dirty solution with a lot of boilerplate code, but it worked as a first approach. Later I found myself in the same problem when querying a different API and I realised that a more structured approach was necessary. </p>
<p>Some time later I found out the existence of the <a href="https://github.com/RazerM/ratelimiter">ratelimiter</a> package, and to my surprise: it also used context managers and the code looked very similar ! In addition, the package features a very neat usage of the decorator syntax and implements both synchronous and asynchronous versions.  </p>
<p>In this article we are going to go through the basics of the context manager functionality, and then see it in action when implemented into a rate limiter class. </p>
<h2>The purpose of context managers</h2>
<p>The purpose of a context manager is to encapsulate a sequence of "setup" and "teardown" steps into a neat block of code. Any code that runs within that block runs within the context of a particular resource that is created in the process. In the background, a context manager implements this process for you. This process usually involves some sort of creation followed by deletion, an opening followed by closing (of a connection, for example), a building step followed by a breaking step (more metaphors are welcome).  </p>
<p>Sounds confusing ? Don't worry, let's clear it up with some examples. </p>
<h3>Opening a file</h3>
<p>To open a file in Python you would usually write the follwing: </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">Hello World</code></pre></div>
<p>Notice the <code class="language-text">open</code> and <code class="language-text">close</code> logic. </p>
<p>This code is equivalent to the following context manager: </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token comment">## inside the context manager block </span>
    text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    
<span class="token comment">## outside the context manager block </span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">Hello World</code></pre></div>
<p>With a context manmager, the user no longer has to explicitely specify the closing step: the context manager does it for you as soon as you start a new line outside the block. Neat. </p>
<h2>Building a context manager ...</h2>
<h2>... as a class</h2>
<p>A context manager can be implemented with special class underscore methods, namely <code class="language-text">__enter__</code> and <code class="language-text">__exit__</code>. </p>
<p>Let's implement the file reader context manager: </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">readfile</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> method<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Code to acquire resource</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>> __enter__'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>f
        
    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># __exit__ takes 3 extra arguments that we don't need to worry about</span>
        <span class="token comment"># Code to release resource</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>> __exit__'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">with</span> readfile<span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token operator">>></span> __enter__
Hello World

<span class="token operator">>></span> __exit__</code></pre></div>
<p>Note how <code class="language-text">self.f</code>, the resource object, is passed around the class and is ultimately surfaced by the <code class="language-text">__enter__</code> method which allows the used to interact with the object inside the block of the context manager. </p>
<h3>...as a generator</h3>
<p>If you're familiar with Python generators and the logic you're writing is simple enough, you can implement a context manager with the generator syntax. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager

<span class="token decorator annotation punctuation">@contextmanager</span>
<span class="token keyword">def</span> <span class="token function">readfile</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Code to acquire resource</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> method<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>> yield'</span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> f
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        <span class="token comment"># Code to release resource</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>> finally'</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">with</span> readfile<span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token operator">>></span> yield
Hello World

<span class="token operator">>></span> finally</code></pre></div>
<p>This syntax looks much simpler by using the <code class="language-text">contextmanager</code> function to decorate the generator and convert it into a context manager. In the  background this decorator implements the <code class="language-text">__enter__</code> and <code class="language-text">__exit__</code> methods for us so we don't have to worry about them. All we need is a <code class="language-text">try ... finally</code> logic. </p>
<h2>The request limiter</h2>
<h3>A simulated API</h3>
<p>Let's simulate an API behaviour with the following generator, which normally returns a <code class="language-text">200 OK</code> message when everything is ok, but will return an <code class="language-text">403 Quota Exceeded</code> error message if a pre-defined quota limit has been exceeded. We will interface with the API generator using an intermediary <code class="language-text">call_api</code> function to make things easier on the user side code. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> time 
        
<span class="token keyword">def</span> <span class="token function">API</span><span class="token punctuation">(</span>ping<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    limit <span class="token operator">=</span> <span class="token number">5</span>    <span class="token comment"># allow up to 5 calls ...</span>
    period <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token comment"># ... per second</span>
    calls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>ping<span class="token punctuation">)</span> <span class="token comment"># simulate response delay </span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        call_window <span class="token operator">=</span> <span class="token punctuation">[</span>t <span class="token keyword">for</span> t <span class="token keyword">in</span> calls <span class="token keyword">if</span> now <span class="token operator">-</span> t <span class="token operator">&lt;</span> period<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>call_window<span class="token punctuation">)</span> <span class="token operator">&lt;</span> limit<span class="token punctuation">:</span>
            calls <span class="token operator">=</span> call_window <span class="token operator">+</span> <span class="token punctuation">[</span>now<span class="token punctuation">]</span>
            <span class="token keyword">yield</span> <span class="token string">'200 OK'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> <span class="token string">'403 Quota Exceeded'</span>

api <span class="token operator">=</span> API<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">call_api</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span>api<span class="token punctuation">)</span></code></pre></div>
<p>Now if we simulate this API object with very rapid calls, we should get an error message back once we exceed the quota of 5 calls per second. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> call_api<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'second [</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">] call [</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">second <span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.46</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.62</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.77</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.92</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>: <span class="token number">403</span> Quota Exceeded
second <span class="token punctuation">[</span><span class="token number">1.07</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>: <span class="token number">403</span> Quota Exceeded
second <span class="token punctuation">[</span><span class="token number">1.22</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.37</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.52</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK</code></pre></div>
<p>But if we introduce a long enough delay between the calls, the API will no longer respond with a <code class="language-text">403</code> error message. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> call_api<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'second [</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">] call [</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">second <span class="token punctuation">[</span><span class="token number">0.35</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.71</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.07</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.43</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.79</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">2.15</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">2.50</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">2.86</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">3.21</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">3.57</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK</code></pre></div>
<p>However, this is far from ideal, since we're stuck introducing delays into our code. What we actually would like to do is to be able to call the API as soon as the quota window has passed. We need to keep track of the request times and throttle our own calls. </p>
<h3>First attempt: function wrapper</h3>
<p>Let's start with a function wrapper. Say we need to call the API an arbitrary number of times. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">request_limiter</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> max_calls<span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    calls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># call the api n times</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token comment"># Sleep cycle logic:</span>
        <span class="token comment"># if we're exceeding the limit ...</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>calls<span class="token punctuation">)</span> <span class="token operator">>=</span> max_calls<span class="token punctuation">:</span>
            <span class="token comment"># calculate the minimum sleeping time</span>
            sleeptime <span class="token operator">=</span> period <span class="token operator">-</span> calls<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> calls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 
            <span class="token keyword">if</span> sleeptime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token comment"># and wait</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>sleeptime<span class="token punctuation">)</span>

        <span class="token comment"># API call </span>
        result <span class="token operator">=</span> call_api<span class="token punctuation">(</span><span class="token punctuation">)</span>
        results <span class="token operator">+=</span> <span class="token punctuation">[</span>result<span class="token punctuation">]</span>

        <span class="token comment"># keep track of calls within the time window</span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        calls <span class="token operator">+=</span> <span class="token punctuation">[</span>now<span class="token punctuation">]</span>
        calls <span class="token operator">=</span> <span class="token punctuation">[</span>t <span class="token keyword">for</span> t <span class="token keyword">in</span> calls <span class="token keyword">if</span> now <span class="token operator">-</span> t <span class="token operator">&lt;</span> period<span class="token punctuation">]</span> 
    
    <span class="token keyword">return</span> results</code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">results <span class="token operator">=</span> request_limiter<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> result <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'call [</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">call <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
call <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK</code></pre></div>
<h3>Improved version: as a decorator</h3>
<p>The main limitation of the simple functional implementation above is that we have to provide to it the number of times that we want to query the API in order to be able to then keep a memory of the state inside the function. What if we don't know how many times we need to call the API ? What if these calls come from different places ? </p>
<p>We need to keep track of the calls that we're making dynamically, i.e. the state needs to live outside of the function making the calls: a stateful decorator. </p>
<p>Although stateful decorators can be implemented using the function itself as the <a href="https://realpython.com/primer-on-python-decorators/#stateful-decorators">object state</a>, it's much more intelligible to implement it in a classic class structure.  </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> time
<span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps

<span class="token keyword">class</span> <span class="token class-name">RequestLimiter</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> max_calls<span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>max_calls <span class="token operator">=</span> max_calls <span class="token comment"># number of calls limit</span>
        self<span class="token punctuation">.</span>period <span class="token operator">=</span> period       <span class="token comment"># time window </span>
        self<span class="token punctuation">.</span>calls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            
            <span class="token comment"># Sleep cycle </span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>calls<span class="token punctuation">)</span> <span class="token operator">>=</span> self<span class="token punctuation">.</span>max_calls<span class="token punctuation">:</span>
                sleeptime <span class="token operator">=</span> self<span class="token punctuation">.</span>period <span class="token operator">-</span> self<span class="token punctuation">.</span>_timespan
                <span class="token keyword">if</span> sleeptime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>sleeptime<span class="token punctuation">)</span>
            
            <span class="token comment"># function call </span>
            rv <span class="token operator">=</span> f<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token comment"># `rv` = return value</span>
            
            <span class="token comment"># keep track of calls within the time window</span>
            now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>calls <span class="token operator">+=</span> <span class="token punctuation">[</span>now<span class="token punctuation">]</span>
            self<span class="token punctuation">.</span>calls <span class="token operator">=</span> <span class="token punctuation">[</span>t <span class="token keyword">for</span> t <span class="token keyword">in</span> self<span class="token punctuation">.</span>calls <span class="token keyword">if</span> now <span class="token operator">-</span> t <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>period<span class="token punctuation">]</span>
            
            <span class="token keyword">return</span> rv
        <span class="token keyword">return</span> wrapper

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">_timespan</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> </code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token decorator annotation punctuation">@RequestLimiter</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">call_api_throttled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> call_api<span class="token punctuation">(</span><span class="token punctuation">)</span>

start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> call_api_throttled<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'second [</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">] call [</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">second <span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.46</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.61</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.77</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.46</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.62</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.77</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.92</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK</code></pre></div>
<h3>The context manager version</h3>
<p>In this particular context manager implementation, the context lives outside of the <code class="language-text">with</code> block. However: every time we enter the <code class="language-text">with</code> block we're back again inside the same context and the same state as when we left. Thus, the context manager keeps track of the state outside of the <code class="language-text">with</code> block and enforces the required behaviour when we enter the <code class="language-text">with</code> block. </p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> time
<span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps

<span class="token keyword">class</span> <span class="token class-name">RequestLimiter</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> max_calls<span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>max_calls <span class="token operator">=</span> max_calls <span class="token comment"># number of calls limit</span>
        self<span class="token punctuation">.</span>period <span class="token operator">=</span> period       <span class="token comment"># time window </span>
        self<span class="token punctuation">.</span>calls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Sleep cycle </span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>calls<span class="token punctuation">)</span> <span class="token operator">>=</span> self<span class="token punctuation">.</span>max_calls<span class="token punctuation">:</span>
            sleeptime <span class="token operator">=</span> self<span class="token punctuation">.</span>period <span class="token operator">-</span> self<span class="token punctuation">.</span>_timespan
            <span class="token keyword">if</span> sleeptime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>sleeptime<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># keep track of calls within the time window</span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>calls <span class="token operator">+=</span> <span class="token punctuation">[</span>now<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>calls <span class="token operator">=</span> <span class="token punctuation">[</span>t <span class="token keyword">for</span> t <span class="token keyword">in</span> self<span class="token punctuation">.</span>calls <span class="token keyword">if</span> now <span class="token operator">-</span> t <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>period<span class="token punctuation">]</span>
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">_timespan</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> </code></pre></div>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">limiter <span class="token operator">=</span> RequestLimiter<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># the state lives outside of the function calls </span>
start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> limiter<span class="token punctuation">:</span> 
        <span class="token comment"># >>>>> we enter the context manager's state &lt;&lt;&lt;&lt;&lt;</span>
        <span class="token comment"># ------------------------------------------------</span>
        <span class="token comment"># based on its state, the context manager decides</span>
        <span class="token comment"># when to to execute the code inside the block </span>
        result <span class="token operator">=</span> call_api<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'second [</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">] call [</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">second <span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.46</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.61</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.76</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.46</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.61</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.76</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.92</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK</code></pre></div>
<h3>Adding decorator syntax support</h3>
<p>We can add decorator syntax support with a simple modification of the <code class="language-text">__call__</code> method, just as we did before. However, this time we don 't need to implement the entire logic again: simply make use of the context manager logic within the decorator. </p>
<div class="gatsby-highlight has-highlighted-lines" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> time
<span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps

<span class="token keyword">class</span> <span class="token class-name">RequestLimiter</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> max_calls<span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>max_calls <span class="token operator">=</span> max_calls <span class="token comment"># number of calls limit</span>
        self<span class="token punctuation">.</span>period <span class="token operator">=</span> period       <span class="token comment"># time window </span>
        self<span class="token punctuation">.</span>calls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
<span class="gatsby-highlight-code-line">    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">        <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">            <span class="token keyword">with</span> self<span class="token punctuation">:</span></span><span class="gatsby-highlight-code-line">                <span class="token keyword">return</span> f<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></span><span class="gatsby-highlight-code-line">        <span class="token keyword">return</span> wrapper</span>    
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Sleep cycle </span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>calls<span class="token punctuation">)</span> <span class="token operator">>=</span> self<span class="token punctuation">.</span>max_calls<span class="token punctuation">:</span>
            sleeptime <span class="token operator">=</span> self<span class="token punctuation">.</span>period <span class="token operator">-</span> self<span class="token punctuation">.</span>_timespan
            <span class="token keyword">if</span> sleeptime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>sleeptime<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># keep track of calls within the time window</span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>calls <span class="token operator">+=</span> <span class="token punctuation">[</span>now<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>calls <span class="token operator">=</span> <span class="token punctuation">[</span>t <span class="token keyword">for</span> t <span class="token keyword">in</span> self<span class="token punctuation">.</span>calls <span class="token keyword">if</span> now <span class="token operator">-</span> t <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>period<span class="token punctuation">]</span>
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">_timespan</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> </code></pre></div>
<p>This is as simple and elegant as it gets.</p>
<p>Let's take this decorator for a spin.</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token decorator annotation punctuation">@RequestLimiter</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">call_api_throttled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> call_api<span class="token punctuation">(</span><span class="token punctuation">)</span>

start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> call_api_throttled<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'second [</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">] call [</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">second <span class="token punctuation">[</span><span class="token number">0.15</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.46</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.61</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">0.77</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.31</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.47</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.62</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.77</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK
second <span class="token punctuation">[</span><span class="token number">1.93</span><span class="token punctuation">]</span> call <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>: <span class="token number">200</span> OK</code></pre></div>
<p>Same as before.</p>
<p>Thank you for reading ! </p></div></div><div class="blog-post-module--navlinks--Iep78"><div class="blog-post-module--navprev--1GRP9"><div class="blog-post-module--navlinkdiv--f3pWb"><a href="/python-decorators/"><span style="margin-right:7px">← previous: </span>Learn Python decorators to simplify repeated pieces of logic<span style="margin-left:7px"></span></a></div></div><div class="blog-post-module--navnext--3Yd9-"></div></div></div><footer style="text-align:center">© Evgeny Roskach</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-134214549-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-134214549-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/python-context-managers/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-bfa7222071ec5d114ab1.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-ebda79b2f242b4f85f83.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-1b780e47f8d886e9432d.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4e3b7ac18d070b7f22a9.js"],"component---src-pages-about-me-js":["/component---src-pages-about-me-js-77cd2b963571a295d0de.js"],"component---src-pages-index-js":["/component---src-pages-index-js-42fec5973e9a3bf62a16.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-1b780e47f8d886e9432d.js" async=""></script><script src="/commons-02da7c81015f33fc39a7.js" async=""></script><script src="/styles-277438bf92f1a9bf84e5.js" async=""></script><script src="/app-bfa7222071ec5d114ab1.js" async=""></script><script src="/webpack-runtime-9ffd9fadeba4c79ed312.js" async=""></script></body></html>